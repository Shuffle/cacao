{
  "actions": [
    {
      "app_name": "http",
      "app_version": "1.4.0",
      "description": "This action will set the following firewall rule in Opnsense for IPv4 (host):  ",
      "app_id": "",
      "errors": null,
      "id": "e70f3678-40ca-4ad0-b49f-b7e5038f0a52",
      "is_valid": false,
      "label": "1-Reconfigure Opnsense firewall",
      "public": false,
      "generated": false,
      "name": "POST",
      "parameters": [
        {
          "description": "",
          "id": "",
          "name": "username",
          "example": "",
          "value": "",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": true,
          "configuration": true,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "password",
          "example": "",
          "value": "",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": true,
          "configuration": true,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "url",
          "example": "",
          "value": "https://192.168.1.1/api/firewall/filter/addRule",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": true,
          "configuration": true,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "headers",
          "example": "",
          "value": "Content-type: application/json\n",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "verify",
          "example": "",
          "value": "false",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "timeout",
          "example": "",
          "value": "30",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "body",
          "example": "",
          "value": "{\"rule\":{\"description\":\"OPNsense SOARCA Rule\",\"source_net\":\"__affected_agent_ip__:value\",\"protocol\":\"any\",\"destination_net\":\"__target_net__:value\",\"action\":\"block\",\"interface\":\"lan\"}}",
          "multiline": true,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        }
      ],
      "execution_variable": {
        "description": "",
        "id": "",
        "name": "",
        "value": ""
      },
      "position": {
        "x": 0,
        "y": 0
      },
      "authentication_id": "",
      "category": "",
      "reference_url": "",
      "sub_action": false,
      "source_workflow": "",
      "run_magic_output": false,
      "run_magic_input": false,
      "execution_delay": 0,
      "category_label": null,
      "suggestion": false,
      "parent_controlled": false
    },
    {
      "app_name": "http",
      "app_version": "1.4.0",
      "description": "This action will set the following firewall rule in Opnsense for IPv4 (host):  ",
      "app_id": "",
      "errors": null,
      "id": "332a58d8-e262-410e-8d14-4332225f7bb5",
      "is_valid": false,
      "label": "2-Reconfigure Opnsense firewall",
      "public": false,
      "generated": false,
      "name": "POST",
      "parameters": [
        {
          "description": "",
          "id": "",
          "name": "username",
          "example": "",
          "value": "",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": true,
          "configuration": true,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "password",
          "example": "",
          "value": "",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": true,
          "configuration": true,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "url",
          "example": "",
          "value": "https://192.168.1.1/api/firewall/filter/addRule",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": true,
          "configuration": true,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "headers",
          "example": "",
          "value": "Content-type: application/json\n",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "verify",
          "example": "",
          "value": "false",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "timeout",
          "example": "",
          "value": "30",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "body",
          "example": "",
          "value": "{\"rule\":{\"description\":\"OPNsense SOARCA Rule\",\"source_net\":\"__affected_agent_ip__:value\",\"protocol\":\"any\",\"destination_net\":\"__target_net__:value\",\"action\":\"block\",\"interface\":\"lan\"}}",
          "multiline": true,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "username",
          "example": "",
          "value": "",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": true,
          "configuration": true,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "password",
          "example": "",
          "value": "",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": true,
          "configuration": true,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "url",
          "example": "",
          "value": "https://192.168.1.1/api/firewall/filter/apply",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": true,
          "configuration": true,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "headers",
          "example": "",
          "value": "Content-type: application/json\n",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "verify",
          "example": "",
          "value": "false",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "timeout",
          "example": "",
          "value": "30",
          "multiline": false,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        },
        {
          "description": "",
          "id": "",
          "name": "body",
          "example": "",
          "value": "{}",
          "multiline": true,
          "multiselect": false,
          "options": null,
          "action_field": "",
          "variant": "",
          "required": false,
          "configuration": false,
          "tags": null,
          "schema": {
            "type": ""
          },
          "skip_multicheck": false,
          "value_replace": null,
          "unique_toggled": false,
          "error": ""
        }
      ],
      "execution_variable": {
        "description": "",
        "id": "",
        "name": "",
        "value": ""
      },
      "position": {
        "x": 0,
        "y": 0
      },
      "authentication_id": "",
      "category": "",
      "reference_url": "",
      "sub_action": false,
      "source_workflow": "",
      "run_magic_output": false,
      "run_magic_input": false,
      "execution_delay": 0,
      "category_label": null,
      "suggestion": false,
      "parent_controlled": false
    }
  ],
  "branches": [
    {
      "destination_id": "332a58d8-e262-410e-8d14-4332225f7bb5",
      "id": "83fcd557-09b9-4865-96a6-81deea2815b9",
      "source_id": "e70f3678-40ca-4ad0-b49f-b7e5038f0a52",
      "label": "command 1 to 2",
      "has_errors": false,
      "conditions": null,
      "decorator": false,
      "parent_controlled": false,
      "source_parent": ""
    },
    {
      "destination_id": "4f5df533-d652-4e9e-afbf-aaaf5e4c8c8f",
      "id": "35f3baed-c866-49aa-beb1-9634fad9ad6e",
      "source_id": "332a58d8-e262-410e-8d14-4332225f7bb5",
      "label": "command 2 to end",
      "has_errors": false,
      "conditions": null,
      "decorator": false,
      "parent_controlled": false,
      "source_parent": ""
    }
  ],
  "visual_branches": null,
  "triggers": null,
  "comments": null,
  "configuration": {
    "exit_on_error": false,
    "start_from_top": false,
    "skip_notifications": false
  },
  "created": 1725961605,
  "edited": 1725961605,
  "last_runtime": 0,
  "due_date": 0,
  "id": "300f5c47-c53a-4bff-b6d1-dd9a6062a0bf",
  "is_valid": false,
  "name": "Add block rule in OPNsense",
  "description": "This playbook will add a block rule in OPNsense",
  "start": "8e717805-03ec-4b8d-a969-7382370d2a39",
  "owner": "",
  "sharing": "",
  "execution_org": {
    "name": "",
    "id": "",
    "users": null,
    "role": "",
    "creator_org": "",
    "image": "",
    "child_orgs": null,
    "region_url": ""
  },
  "workflow_variables": null,
  "execution_environment": "",
  "previously_saved": false,
  "categories": {
    "siem": {
      "name": "",
      "count": 0,
      "id": "",
      "description": "",
      "large_image": ""
    },
    "communication": {
      "name": "",
      "count": 0,
      "id": "",
      "description": "",
      "large_image": ""
    },
    "assets": {
      "name": "",
      "count": 0,
      "id": "",
      "description": "",
      "large_image": ""
    },
    "cases": {
      "name": "",
      "count": 0,
      "id": "",
      "description": "",
      "large_image": ""
    },
    "network": {
      "name": "",
      "count": 0,
      "id": "",
      "description": "",
      "large_image": ""
    },
    "intel": {
      "name": "",
      "count": 0,
      "id": "",
      "description": "",
      "large_image": ""
    },
    "edr": {
      "name": "",
      "count": 0,
      "id": "",
      "description": "",
      "large_image": ""
    },
    "iam": {
      "name": "",
      "count": 0,
      "id": "",
      "description": "",
      "large_image": ""
    },
    "email": {
      "name": "",
      "count": 0,
      "id": "",
      "description": "",
      "large_image": ""
    },
    "other": {
      "name": "",
      "count": 0,
      "id": "",
      "description": "",
      "large_image": ""
    }
  },
  "example_argument": "",
  "public": false,
  "default_return_value": "",
  "contact_info": {
    "name": "",
    "url": ""
  },
  "published_id": "",
  "revision_id": "",
  "usecase_ids": null,
  "input_questions": null,
  "input_markdown": "",
  "output_yields": null,
  "blogpost": "",
  "video": "",
  "status": "",
  "workflow_type": "CACAO playbook",
  "generated": false,
  "hidden": false,
  "updated_by": "identity--69531c15-ce04-4076-856f-088e55acca3d",
  "validated": false,
  "validation": {
    "valid": false,
    "changed_at": 0,
    "last_valid": 0,
    "validation_ran": false,
    "workflow_id": "",
    "execution_id": "",
    "node_id": "",
    "total_problems": 0,
    "errors": null,
    "subflow_apps": null
  },
  "parentorg_workflow": "",
  "childorg_workflow_ids": null,
  "suborg_distribution": null,
  "backup_config": {
    "upload_repo": "",
    "upload_branch": "",
    "upload_username": "",
    "upload_token": "",
    "tokens_encrypted": false
  },
  "auth_groups": null
}